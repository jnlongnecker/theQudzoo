<template>
    <c-popup>
        <span slot="header">:choose variant:</span>
        <ul class="insert-variant">
            <template for:each={variantChoices} for:item="variant" for:index="i">
                <li key={variant.name}>
                    <button class="v-button" data-index={i} onclick={variantChosen}>
                        {variant.type}
                    </button>
                </li>
            </template>
        </ul>
    </c-popup>
    <section>
        <div class="mutations">
            <template for:each={mutations} for:item="category">
                <fieldset key={category.id}>
                    <legend class={category.class}>{category.data.displayName}</legend>
                    <ul>
                        <template for:each={category.data.mutations} for:item="mut">
                            <div class={mut.format} key={mut.name} onmouseenter={mutHover} onclick={mutClick}
                                data-name={mut.name} data-category={category.data.name}>
                                <div class="mutation-line">
                                    <span>
                                        [<span class="marker">{mut.marker}</span>]
                                    </span>
                                    <span>
                                        [<span class="positive">{mut.cost}</span>]
                                    </span>
                                    <span class="mutation-name">
                                        {mut.displayName}
                                    </span>
                                    <div class="variations" if:true={mut.variants}>
                                        <button class="v-button" onclick={chooseVariant}
                                            data-category={category.data.name} data-name={mut.name}>Variant</button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </ul>
                </fieldset>
            </template>
        </div>
        <hr />
        <div class="blurb" onclick={hideBlurb}>
            <fieldset>
                <legend class="legend-img">
                    <img if:true={selectedSrc} src={selectedSrc} class="mut-img" />
                </legend>
                <div class="blurb-format">
                    <span>{selectedMutation}</span>
                    <build-markdown-renderer modes="all-qud-font bolded inline no-highlight" slow-load shaders-only
                        raw-text={selectedText} if:true={selectedText}></build-markdown-renderer>
                </div>
            </fieldset>
        </div>
    </section>
</template>